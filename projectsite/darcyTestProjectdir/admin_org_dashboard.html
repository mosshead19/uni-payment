{% extends 'base.html' %}
{% block title %}{{ organization.name }} - Dashboard{% endblock %}
{% block content %}
<div class="card border-0 shadow-2xl mb-4" style="background: var(--gradient-primary); border: 1px solid rgba(255,255,255,0.1);">
  <div class="card-body p-4 d-flex justify-content-between align-items-center">
    <div>
      <h3 class="mb-1 fw-bold text-white"><i class="fas fa-building me-2"></i>{{ organization.name }}</h3>
      <p class="mb-0 text-white-50">Code: {{ organization.code }}</p>
    </div>
    <span class="badge bg-white text-dark">Admin View</span>
  </div>
</div>

<div class="row g-4 mb-4">
  <div class="col-md-4">
    <div class="card stat-card border-0 shadow-lg gradient-card" style="background: var(--bg-card);">
      <div class="card-body">
        <p class="text-white-50 small text-uppercase fw-bold mb-2">Today's Net Collection</p>
        <h2 class="mb-0 fw-bold text-white">₱{{ today_collections|floatformat:2 }}</h2>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card stat-card border-0 shadow-lg gradient-card" style="background: var(--bg-card);">
      <div class="card-body">
        <p class="text-white-50 small text-uppercase fw-bold mb-2">Total Collected</p>
        <h2 class="mb-0 fw-bold text-white">₱{{ total_collected|floatformat:2 }}</h2>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card stat-card border-0 shadow-lg gradient-card" style="background: var(--bg-card);">
      <div class="card-body">
        <p class="text-white-50 small text-uppercase fw-bold mb-2">Active Pending Requests</p>
        <h2 class="mb-0 fw-bold text-white">{{ pending_requests|length }}</h2>
      </div>
    </div>
  </div>
</div>

<div class="row g-4">
  <div class="col-md-6">
    <div class="card border-0 shadow-lg" style="background: var(--bg-card);">
      <div class="card-header border-0 py-3" style="background: var(--gradient-warning);"><h5 class="mb-0 fw-bold text-white"><i class="fas fa-list-ol me-2"></i>Queue for {{ organization.code }}</h5></div>
      <div class="card-body p-0">
        {% if pending_requests %}
        <ul class="list-group list-group-flush">
          {% for r in pending_requests %}
          <li class="list-group-item" style="background: transparent; border-bottom: 1px solid rgba(255,255,255,0.1)">
            <span class="badge bg-info me-2">{{ r.queue_number }}</span>{{ r.student.get_full_name }} - ₱{{ r.amount|floatformat:2 }}
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <div class="text-center py-5 text-white-50">No active requests in the queue</div>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card border-0 shadow-lg" style="background: var(--bg-card);">
      <div class="card-header border-0 py-3" style="background: var(--gradient-warm);"><h5 class="mb-0 fw-bold text-white"><i class="fas fa-receipt me-2"></i>Recent Payments</h5></div>
      <div class="card-body p-0">
        {% if recent_payments %}
        <ul class="list-group list-group-flush">
          {% for p in recent_payments %}
          <li class="list-group-item" style="background: transparent; border-bottom: 1px solid rgba(255,255,255,0.1)">
            <strong class="text-success">OR#{{ p.or_number }}</strong> — {{ p.student.get_full_name }} — ₱{{ p.amount|floatformat:2 }}
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <div class="text-center py-5 text-white-50">No recent payments found</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
